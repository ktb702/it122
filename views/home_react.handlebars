{{!--  
 Author: Kate Baldwin
 Course: IT122  (Week 6 - REACT & SPA's)
 File: home_react.handlebars
 Created: 09/22/2020
 Desc: Create a new React-based home page. Your new SPA page should:
    Show a list of the items in your database 
    Show item details when one is selected    --}}

<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Cars React App</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <!-- Don't use this in production: -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">

    const CarList = (props) => {
      return <div>
        <h1>Here is a list of cars currently available. Click on the model for more details.</h1>
        <ul>
          {props.items.map(item => <li onClick={props.clickHandler} key={item.model}>{item.model}</li>)}
        </ul>
      </div>
    }

    const CarDetail = (props) => {
      console.log(props);
      return <div>
        <h2>Details for {props.item.model} :</h2>
        <p>Year:  {props.item.year}</p>
        <p>Make:  {props.item.make}</p>
        <p>Model: {props.item.model}</p>
        <p>Color: {props.item.color}</p>
    </div>
    }

class CarApp extends React.Component{
      constructor(props){
          super(props);
          // Set initial state using data from server application
          this.state = {
            items: {{{ cars }}},
            currentCar: { }, // current selected item
            isToggleOn: true,
          };

          // bind application state to click handler
          this.selectItem = this.selectItem.bind(this);
          //this.showDetails = this.showDetails.bind(this);
          //this.onChange
          //this.onSave
          //this.onDelete
          //this.onClear 
       }

      // handle list item clicked
      selectItem(event) {
        // event.target is the HTML item clicked
        console.log(event.target.innerText);
        let selected = event.target.innerText
        let newCar = this.state.items.find((item) => {
            return item.model == selected
        })
        this.setState({currentCar: newCar});
      }

      render() {
        // render app UI elements
        return (
          <div>
          <h1>Welcome to the Car Shop! </h1>
          <CarList items={this.state.items} clickHandler={this.selectItem} />
          <CarDetail item={this.state.currentCar} />
          </div>
          );
      }
    }
 
    ReactDOM.render(<CarApp />, document.getElementById('root'));

    </script>
  </body>
</html>